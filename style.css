/* === Theme variables (dark default) === */
:root{
  --bg:#0b1220;
  --panel:#0f172a;
  --ink:#e5e7eb;
  --ink-soft:#cbd5e1;
  --brand:#0b1220;
  --accent:#60a5fa;
  --shadow:0 8px 24px rgba(0,0,0,.35);
  --grid:#1f2937;
  --cardH: clamp(340px, 42vh, 560px);
  --chartH: clamp(260px, 38vh, 420px);
}

:root[data-theme="light"]{
  --bg:#f6f7fb;
  --panel:#ffffff;
  --ink:#1f2937;
  --ink-soft:#475569;
  --brand:#0f172a;
  --accent:#2563eb;
  --shadow:0 4px 16px rgba(0,0,0,.08);
  --grid:#e5e7eb;
}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
body {
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Helvetica Neue", sans-serif;
  margin: 0;
  background: var(--bg);
  color: var(--ink);
}

/* Header */
header { background: var(--brand); color: #fff; padding: 1rem; }
.header-row{ display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; }
header h1{margin:.2rem 0 0}
header p{margin:.2rem 0 0; color:#9fb3d1}
#themeToggle{ background:transparent; color:#e2e8f0; border:1px solid #64748b; border-radius:10px; padding:.5rem .8rem; cursor:pointer; }
#themeToggle:hover{ filter:brightness(1.15); }

/* Filtros */
#filtros {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: .75rem;
  padding: 1rem;
  background: color-mix(in oklab, var(--panel) 85%, transparent);
  align-items:end;
  border-top:1px solid #33415522;
  border-bottom:1px solid #33415522;
}
.filtro-item{
  display:flex;
  flex-direction:column;
  gap:.35rem;
}
#filtros label{
  font-size:.9rem;
  color: var(--ink-soft);
}
#filtros select,#filtros input[type="date"], #filtros input[type="number"]{
  width:100%;
  padding:.55rem .6rem;
  border-radius:10px;
  border:1px solid #33415522;
  background:var(--panel);
  color: var(--ink);
}
#btnLimpiar{
  padding:.6rem .8rem; border-radius:10px; border:1px solid #33415522; background:var(--panel); color:var(--ink); cursor:pointer;
}
#btnLimpiar:hover{ filter:brightness(1.05); }

/* KPIs */
#kpis{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  padding: 1rem;
}
.kpi{
  background: var(--panel);
  border-radius: 12px;
  box-shadow: var(--shadow);
  border:1px solid #33415522;
  padding: .9rem;
}
.kpi-title{ font-size:.85rem; color: var(--ink-soft); }
.kpi-value{ font-size:1.4rem; font-weight:700; margin-top:.2rem; }

/* Gráficos */
#graficos {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 1rem;
  padding: 1rem;
}
.grafico-container {
  background: var(--panel);
  padding: 1rem;
  border-radius: 12px;
  box-shadow: var(--shadow);
  border:1px solid #33415522;
  display:grid;
  grid-template-rows: auto auto auto; /* título, chart-area, legend */
  overflow:visible;
  min-height: var(--cardH); /* base uniforme; puede crecer por leyendas */
  height:auto;
}
.grafico-container h2{
  margin:.2rem 0 .6rem;
  font-size:1.02rem;
  font-weight:600;
  color: var(--ink);
}

/* Chart area => altura controlada para evitar scroll infinito */
.chart-area{
  position:relative;
  width:100%;
  height: var(--chartH);
  contain: content;
}
.chart-area canvas{
  width: 100% !important;
  height: 100% !important;
  display:block;
}

/* HTML Legend */
.legend{ display:flex; flex-wrap:wrap; gap:.6rem .8rem; margin-top:.6rem; }
.legend .item{ display:inline-flex; align-items:center; gap:.55rem; font-size:.95rem; color:var(--ink); background:color-mix(in oklab, var(--panel) 90%, transparent); border:1px solid #2a3b57; border-radius:999px; padding:.28rem .7rem; cursor:pointer; }
:root[data-theme="light"] .legend .item{ border-color:#cbd5e1; }
.legend .item:hover{ filter:brightness(1.05) }
.legend .swatch{ width:13px; height:13px; border-radius:3px; display:inline-block; }

/* Noticias grid */
#noticias {
  padding: 1rem;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 1rem;
}

.noticia {
  background: var(--panel);
  border-radius: 12px;
  padding: 1rem;
  box-shadow: var(--shadow);
  border:1px solid #33415522;
}
.noticia h2 { margin: 0 0 .5rem 0; font-size: 1.05rem; line-height:1.4; }
.noticia h2 a { color: var(--accent); text-decoration: none; }
.noticia h2 a:hover { text-decoration: underline; }
.noticia p{margin:.25rem 0}

footer {
  background: var(--brand);
  color: white;
  text-align: center;
  padding: .8rem;
  margin-top: .5rem;
  font-size:.9rem;
}

/* Mobile tweaks */
@media (max-width: 520px){
  header h1{font-size:1.25rem}
  :root{ --cardH: clamp(320px, 50vh, 560px); --chartH: clamp(220px, 44vh, 420px); }
}
